// Multi-language translation content
const translations = {
  "en": {
    "heroTitle": "The Next Generation Blockchain Game",
    "heroSubtitle": "Experience an ARC-driven realm where adventure meets blockchain.",
    "ctaPrimary": "Participate Now",
    "ctaSecondary": "View Whitepaper",
    "navGame": "Game",
    "navToken": "Token",
    "navDividends": "Dividends",
    "navCommunity": "Community",
    "navSubscribe": "Subscribe",
    "gameIntroTitle": "Game Introduction",
    "tokenInfoTitle": "Token Information",
    "dividendDemoTitle": "Dividend Demonstration",
    "subscriptionTitle": "Subscription Progress",
    "communityTitle": "Community & Governance",
    "feature1Title": "Map Mechanism",
    "feature1Desc": "Explore a vast world with a dynamic map system that evolves as you play.",
    "feature2Title": "Special Gameplay",
    "feature2Desc": "Unique challenges and trials that set this game apart from the rest.",
    "feature3Title": "Fragment Drops",
    "feature3Desc": "Collect valuable fragments throughout your adventures to boost your power.",
    "feature4Title": "Team Battles",
    "feature4Desc": "Form teams and engage in epic battles for territory and glory.",
    "feature5Title": "Prediction Contests",
    "feature5Desc": "Take part in prediction contests and win rewards based on outcomes.",
    "burnTitle": "Burn",
    "burnDesc": "A portion of tokens is burned to reduce supply and increase value.",
    "releaseTitle": "Release",
    "releaseDesc": "New tokens are released gradually to support ecosystem growth.",
    "lockTitle": "Lock",
    "lockDesc": "Certain tokens are locked in reserve to stabilize the economy.",
    "dividendTitle": "Dividends",
    "dividendDesc": "Token holders receive regular USDT dividends from game revenues.",
    "holdingsLabel": "NFT Holdings",
    "calculateBtn": "Calculate",
    "dividendResultPrefix": "Estimated Monthly Dividends: ",
    "subscribedLabel": "Subscribed Shares",
    "raisedLabel": "Raised Amount",
    "communityItem1Title": "Shareholder Voting",
    "communityItem1Desc": "Token holders can vote on major game decisions.",
    "communityItem2Title": "Governance Mechanism",
    "communityItem2Desc": "A transparent process to guide the project’s development.",
    "communityItem3Title": "Dual Dividends",
    "communityItem3Desc": "Receive dividends in both USDT and ARC tokens for holding NFTs.",
    "communityItem4Title": "On-chain Transparency",
    "communityItem4Desc": "All governance and reward records are publicly verifiable on-chain."
  },
  "zh": {
    "heroTitle": "下一代区块链游戏",
    "heroSubtitle": "体验由ARC驱动的领域，冒险与区块链融合。",
    "ctaPrimary": "立即参与",
    "ctaSecondary": "查看白皮书",
    "navGame": "游戏",
    "navToken": "代币",
    "navDividends": "分红",
    "navCommunity": "社区",
    "navSubscribe": "认购",
    "gameIntroTitle": "游戏介绍",
    "tokenInfoTitle": "代币信息",
    "dividendDemoTitle": "分红案例演示",
    "subscriptionTitle": "实时认购进度",
    "communityTitle": "社区与治理",
    "feature1Title": "地图机制",
    "feature1Desc": "地图机制介绍。",
    "feature2Title": "特色玩法",
    "feature2Desc": "特色玩法介绍。",
    "feature3Title": "碎片掉落",
    "feature3Desc": "碎片掉落介绍。",
    "feature4Title": "团队对抗",
    "feature4Desc": "团队对抗介绍。",
    "feature5Title": "竞猜玩法",
    "feature5Desc": "竞猜玩法介绍。",
    "burnTitle": "销毁",
    "burnDesc": "部分代币将被销毁以减少供应、提高价值。",
    "releaseTitle": "释放",
    "releaseDesc": "新代币将逐步释放，以支持生态发展。",
    "lockTitle": "锁仓",
    "lockDesc": "部分代币锁定储备，以稳定经济。",
    "dividendTitle": "分红",
    "dividendDesc": "持币者可从游戏收入中定期获得 USDT 分红。",
    "holdingsLabel": "NFT 持有量",
    "calculateBtn": "计算",
    "dividendResultPrefix": "预计每月分红: ",
    "subscribedLabel": "已认购份额",
    "raisedLabel": "认购金额",
    "communityItem1Title": "股东投票",
    "communityItem1Desc": "持有者可对重大游戏决策进行投票。",
    "communityItem2Title": "治理机制",
    "communityItem2Desc": "透明的流程引导项目发展。",
    "communityItem3Title": "双重分红",
    "communityItem3Desc": "持有NFT可同时获得 USDT 和 ARC 的分红。",
    "communityItem4Title": "链上透明",
    "communityItem4Desc": "所有治理和奖励记录均可在链上公开验证。"
  },
  "ar": {
    "heroTitle": "أحدث تجربة لألعاب البلوكشين",
    "heroSubtitle": "اختبر عالماً مدعوماً بـ ARC حيث تلتقي المغامرة بالبلوكتشين.",
    "ctaPrimary": "شارك الآن",
    "ctaSecondary": "عرض الورقة البيضاء",
    "navGame": "اللعبة",
    "navToken": "الرمز",
    "navDividends": "التوزيعات",
    "navCommunity": "المجتمع",
    "navSubscribe": "الاكتتاب",
    "gameIntroTitle": "مقدمة اللعبة",
    "tokenInfoTitle": "معلومات الرمز",
    "dividendDemoTitle": "عرض التوزيعات",
    "subscriptionTitle": "تقدم الاشتراك",
    "communityTitle": "المجتمع والحوكمة",
    "feature1Title": "آلية الخريطة",
    "feature1Desc": "وصف آلية الخريطة.",
    "feature2Title": "أسلوب لعب مميز",
    "feature2Desc": "وصف أسلوب اللعب المميز.",
    "feature3Title": "إسقاط الشظايا",
    "feature3Desc": "وصف إسقاط الشظايا.",
    "feature4Title": "معارك الفرق",
    "feature4Desc": "وصف معارك الفرق.",
    "feature5Title": "مسابقات التوقع",
    "feature5Desc": "وصف مسابقات التوقع.",
    "burnTitle": "الحرق",
    "burnDesc": "يتم حرق جزء من الرموز لتقليل المعروض وزيادة القيمة.",
    "releaseTitle": "الإصدار",
    "releaseDesc": "يتم إصدار رموز جديدة تدريجياً لدعم نمو النظام.",
    "lockTitle": "القفل",
    "lockDesc": "يتم قفل بعض الرموز في الاحتياطي لتحقيق الاستقرار الاقتصادي.",
    "dividendTitle": "التوزيعات",
    "dividendDesc": "يتلقى حاملو الرموز توزيعات USDT منتظمة من عائدات اللعبة.",
    "holdingsLabel": "عدد NFT المحتفظ بها",
    "calculateBtn": "احسب",
    "dividendResultPrefix": "التوزيعات الشهرية المقدرة: ",
    "subscribedLabel": "الحصص المكتتبة",
    "raisedLabel": "المبلغ المُجمّع",
    "communityItem1Title": "تصويت المساهمين",
    "communityItem1Desc": "يمكن لحملة الرموز التصويت على القرارات الرئيسية للعبة.",
    "communityItem2Title": "آلية الحوكمة",
    "communityItem2Desc": "عملية شفافة لتوجيه تطوير المشروع.",
    "communityItem3Title": "توزيعات مزدوجة",
    "communityItem3Desc": "احصل على توزيعات بكل من USDT و ARC مقابل الاحتفاظ بـ NFT.",
    "communityItem4Title": "شفافية على السلسلة",
    "communityItem4Desc": "جميع سجلات الحوكمة والمكافآت قابلة للتحقق علناً على السلسلة."
  }
};

// Set initial language
let currentLang = "en";

// Function to switch language and update all text content
function changeLanguage(lang) {
  if (!translations[lang]) return;
  currentLang = lang;
  // Update language attribute and text direction for RTL languages
  document.documentElement.lang = lang;
  if (lang === "ar") {
    document.documentElement.dir = "rtl";
  } else {
    document.documentElement.dir = "ltr";
  }
  // Update all elements with data-i18n attributes
  document.querySelectorAll("[data-i18n]").forEach(el => {
    const key = el.getAttribute("data-i18n");
    if (key && translations[lang][key] !== undefined) {
      el.textContent = translations[lang][key];
    }
  });
  // Update token detail text to match current selection in new language
  if (currentTokenPart) {
    const detailEl = document.getElementById("token-detail");
    if (detailEl) {
      detailEl.textContent = translations[lang][currentTokenPart + "Desc"];
    }
  }
  // Update dividend result text if already calculated
  const resultEl = document.getElementById("dividend-result");
  const inputEl = document.getElementById("nft-count");
  if (resultEl && inputEl && inputEl.value) {
    // Recalculate the dividend display using current input
    const nftCount = parseFloat(inputEl.value) || 0;
    const usdtDividend = (nftCount * 5).toFixed(0);
    const arcDividend = (nftCount * 50).toFixed(0);
    const prefix = translations[lang]["dividendResultPrefix"] || "";
    resultEl.textContent = prefix + usdtDividend + " USDT + " + arcDividend + " ARC";
  }
  // Highlight active language button
  document.querySelectorAll(".lang-switch button").forEach(btn => {
    btn.classList.toggle("active-lang", btn.getAttribute("data-lang") === lang);
  });
}

// Handle language switcher button clicks
document.querySelectorAll(".lang-switch button").forEach(button => {
  button.addEventListener("click", () => {
    const lang = button.getAttribute("data-lang");
    changeLanguage(lang);
  });
});

// Mobile menu toggle
const menuToggle = document.getElementById("menu-toggle");
const headerEl = document.querySelector("header");
if (menuToggle && headerEl) {
  menuToggle.addEventListener("click", () => {
    headerEl.classList.toggle("nav-open");
  });
}

// Interactive Token tabs
let currentTokenPart = "burn"; // default selected token part
const tokenTabs = document.querySelectorAll(".token-tabs li");
const tokenDetail = document.getElementById("token-detail");
tokenTabs.forEach(tab => {
  tab.addEventListener("click", () => {
    // Remove active class from all tabs, then add to clicked one
    tokenTabs.forEach(t => t.classList.remove("active"));
    tab.classList.add("active");
    // Update current token part and detail text
    currentTokenPart = tab.getAttribute("data-part");
    if (tokenDetail) {
      tokenDetail.textContent = translations[currentLang][currentTokenPart + "Desc"];
    }
  });
});

// Dividend calculator logic
const calcBtn = document.getElementById("calc-btn");
if (calcBtn) {
  calcBtn.addEventListener("click", () => {
    const nftInput = document.getElementById("nft-count");
    const resultEl = document.getElementById("dividend-result");
    if (!nftInput || !resultEl) return;
    const count = parseFloat(nftInput.value) || 0;
    // Example calculation: each NFT yields 5 USDT + 50 ARC per month (demonstration values)
    const usdtDividend = (count * 5).toFixed(0);
    const arcDividend = (count * 50).toFixed(0);
    const prefix = translations[currentLang]["dividendResultPrefix"] || "";
    resultEl.textContent = prefix + usdtDividend + " USDT + " + arcDividend + " ARC";
  });
}

// Subscription progress counter animation
function animateCounters() {
  const counters = document.querySelectorAll("#subscription-status [data-target]");
  counters.forEach(counter => {
    const updateCount = () => {
      const target = Number(counter.getAttribute("data-target"));
      const current = Number(counter.innerText);
      const step = Math.ceil(target / 50); // increment step (adjust speed here)
      if (current < target) {
        counter.innerText = current + step;
        if (counter.innerText > target) {
          counter.innerText = target;
        }
        requestAnimationFrame(updateCount);
      } else {
        counter.innerText = target;
      }
    };
    updateCount();
  });
}

// Scroll-trigger animations (fade-in sections and counters)
const fadeInElems = document.querySelectorAll(".fade-in");
const observer = new IntersectionObserver(entries => {
  entries.forEach(entry => {
    if (entry.isIntersecting) {
      const elem = entry.target;
      elem.classList.add("show");
      observer.unobserve(elem);
      // If this element is subscription section, trigger counters animation
      if (elem.id === "subscription-status") {
        animateCounters();
      }
    }
  });
}, { threshold: 0.1 });
fadeInElems.forEach(elem => {
  observer.observe(elem);
});

// Page load event: hide loading screen and initialize language
window.addEventListener("load", () => {
  // Hide loading overlay once page resources are loaded
  const loadingOverlay = document.getElementById("loading");
  if (loadingOverlay) {
    loadingOverlay.style.display = "none";
  }
  // Initialize default language content
  changeLanguage(currentLang);
});

// Wallet button placeholder functionality
document.querySelectorAll(".wallet-btn").forEach(btn => {
  btn.addEventListener("click", () => {
    alert("Wallet connect feature is not implemented in this demo.");
    // Placeholder: Integrate Web3 wallet connection logic here in future
  });
});










